function getWidgetSelectorURL(){return $cbEditorConfig.adminEntryURL+"/widgets/editorselector"}function getWidgetPreviewURL(){return $cbEditorConfig.adminEntryURL+"/widgets/preview"}function getWidgetEditorURL(){return $cbEditorConfig.adminEntryURL+"/widgets/editinstance"}function getWidgetInstanceURL(){return $cbEditorConfig.adminEntryURL+"/widgets/viewWidgetInstance"}function getPageSelectorURL(){return $cbEditorConfig.adminEntryURL+"/pages/editorselector"}function getEntrySelectorURL(){return $cbEditorConfig.isBlogDisabled?"":$cbEditorConfig.adminEntryURL+"/entries/editorselector"}function getContentStoreSelectorURL(){return $cbEditorConfig.adminEntryURL+"/contentStore/editorselector"}function getPreviewSelectorURL(){return $cbEditorConfig.adminEntryURL+"/content/preview"}function getAuthorEditorPreferenceURL(){return $cbEditorConfig.adminEntryURL+"/authors/changeEditor"}function getAuthorSavePreferenceURL(){return $cbEditorConfig.adminEntryURL+"/authors/saveSinglePreference"}function getModuleURL(t,e,o){var r="";return $.ajax({url:$cbEditorConfig.adminEntryURL+"/modules/buildModuleLink",data:{module:t,moduleEvent:e,moduleQS:o},async:!1,success:function(t){r=t}}),$.trim(r)}function loadAssetChooser(t,e,o){openRemoteModal($cbEditorConfig.adminEntryURL+"/ckFileBrowser/assetChooser?callback="+t,{},e||"75%",o)}function switchEditor(t){confirm("Would you like to save your work before switching editors?")&&($changelog.val("Editor Change Quick Save"),quickSave()),$.ajax({url:getAuthorEditorPreferenceURL(),data:{editor:t},async:!1,success:function(t){location.reload()}})}function setupEditors(t,e,o,r){$targetEditorForm=t,$targetEditorSaveURL=o,$uploaderBarLoader=$targetEditorForm.find("#uploadBarLoader"),$uploaderBarStatus=$targetEditorForm.find("#uploadBarLoaderStatus"),$excerpt=$targetEditorForm.find("#excerpt"),$content=$targetEditorForm.find("#content"),$isPublished=$targetEditorForm.find("#isPublished"),$contentID=$targetEditorForm.find("#contentID"),$changelog=$targetEditorForm.find("#changelog"),$slug=$targetEditorForm.find("#slug"),$publishingBar=$targetEditorForm.find("#publishingBar"),$actionBar=$targetEditorForm.find("#actionBar"),$publishButton=$targetEditorForm.find("#publishButton"),$withExcerpt=e||!0,$wasSubmitted=!1,$cbEditorStartup(),$("[type=date]").datepicker({format:"yyyy-mm-dd"}),$(".datepicker").datepicker({format:"yyyy-mm-dd"}),$targetEditorForm.validate({ignore:"content",submitHandler:function(t){try{updateEditorContent()}catch(t){console.log(t)}if($withExcerpt)try{updateEditorExcerpt()}catch(t){console.log(t)}$content.val().length?($slug.prop("disabled",!1),$publishButton.prop("disabled",!0),t.submit()):alert("Please enter some content!")}}),$cbEditorConfig.changelogMandatory&&$changelog.attr("required",$cbEditorConfig.changelogMandatory);var a=$targetEditorForm.find("#title");a.on("blur",(function(){$slug.prop("disabled")||createPermalink(a.val())})),$slug.on("blur",(function(){$(this).prop("disabled")||permalinkUniqueCheck()})),window.onbeforeunload=askLeaveConfirmation,$("#htmlKeywords").keyup((function(){$("#html_keywords_count").html($("#htmlKeywords").val().length)})),$("#htmlDescription").keyup((function(){$("#html_description_count").html($("#htmlDescription").val().length)})),$(".clockpicker").clockpicker(),autoSave($content,$contentID,"contentAutoSave");var n=$("#container");(r=r||!0)&&!$(n).hasClass("sidebar-mini")&&($("body").removeClass("off-canvas-open"),$(n).toggleClass("sidebar-mini"))}function shouldPublish(){return!$contentID.val().length||"true"!=$isPublished.val()||confirm("Your content is published already, quick saving it will draft it and unpublish it.If you want to re-publish, just hit Publish again.Are you sure you want to draft the content?")}function quickSave(){if(shouldPublish()){if($isPublished.val("false"),$changelog.val().length||$changelog.val("quick save"),!$targetEditorForm.valid())return adminNotifier("error","Form is not valid, please verify."),!1;if(getEditorContent().length){toggleLoaderBar(),$content.val().length||$content.val(getEditorContent());var t=!1;$slug.prop("disabled")&&($slug.prop("disabled",!1),t=!0),$.post($targetEditorSaveURL,$targetEditorForm.serialize(),(function(e){$contentID.val(e.CONTENTID),$changelog.val(""),$uploaderBarLoader.fadeOut(1500),$uploaderBarStatus.html("Draft Saved!"),$isPublished.val("true"),t&&$slug.prop("disabled",!0),adminNotifier("info","Draft Saved!")}),"json")}else alert("Please enter content before saving.")}}function previewContent(){openRemoteModal(getPreviewSelectorURL(),{content:getEditorContent(),layout:$("#layout").val(),title:$("#title").val(),slug:$slug.val(),contentType:$("#contentType").val(),markup:$("#markup").val(),parentContent:$("#parentContent").val()||""},$(window).width()-50,$(window).height()-200,!0)}function publishNow(){var t=new Date;$("#publishedDate").val(getToday()),$("#publishedHour").val(t.getHours()),$("#publishedMinute").val(t.getMinutes())}function switchMarkup(t){$("#markup").val(t),$("#markupLabel").html(t)}function setWasSubmitted(){$wasSubmitted=!0}function askLeaveConfirmation(){if(checkIsDirty()&&!$wasSubmitted)return"You have unsaved changes."}function permalinkUniqueCheck(t){t=t||$slug.val(),(t=$.trim(t)).length&&$.getJSON($cbEditorConfig.slugCheckURL,{slug:t,contentID:$("#contentID").val(),contentType:$("#contentType").val()},(function(t){t.UNIQUE?$("#slugCheckErrors").html("").removeClass("alert alert-danger"):$("#slugCheckErrors").html("The permalink slug you entered is already in use, please enter another one or modify it.").addClass("alert alert-danger")}))}function createPermalink(t){var e=$targetEditorForm.find("#title");(t=t||e.val()).length&&(togglePermalink(),$.get($cbEditorConfig.slugifyURL,{slug:t},(function(t){$slug.val(t),permalinkUniqueCheck(),togglePermalink()})))}function togglePermalink(){var t=$("#togglePermalink");t.hasClass("fa fa-lock")?t.attr("class","fa fa-unlock"):t.attr("class","fa fa-lock"),$slug.prop("disabled",!$slug.prop("disabled"))}function toggleDraft(){return!!shouldPublish()&&($isPublished.val("false"),setWasSubmitted(),!0)}function quickPublish(t){if(t){if(!toggleDraft())return}else $isPublished.val("true"),setWasSubmitted();$cbEditorConfig.changelogMandatory&&!isMainSidebarOpen()&&toggleSidebar(),$targetEditorForm.submit()}function toggleLoaderBar(){$uploaderBarStatus.html("Saving..."),$uploaderBarLoader.slideToggle()}function featuredImageCallback(t,e,o){$("#featuredImage").val().length&&cancelFeaturedImage(),$("#featuredImageControls").toggleClass("hide"),$("#featuredImage").val(t),$("#featuredImageURL").val(e),$("#featuredImagePreview").attr("src",e),closeRemoteModal()}function cancelFeaturedImage(){$("#featuredImage").val(""),$("#featuredImageURL").val(""),$("#featuredImagePreview").attr("src",""),$("#featuredImageControls").toggleClass("hide")}autoSave=function(t,e,o,r){if(!Modernizr.localstorage)return $("#"+o).find(".autoSaveBtn").html("Auto Save Unavailable").addClass("disabled"),!1;var a=$.extend({},{storeMax:10,timeout:4e3},r||{}),n=t.attr("id"),i="autosave_"+window.location+"_"+n,l=0,d=!1;localStorage.getItem(i)||localStorage.setItem(i,"[]");var u=JSON.parse(localStorage.getItem(i)),s=function(t){u.push(t),u.length>a.storeMax?function(t){for(var e=u.length-a.storeMax,o=0;o<e;o++)localStorage.removeItem(u[o]),u.splice(o,1);t&&t()}(c):c()},c=function(){localStorage.setItem(i,JSON.stringify(u));for(var t="",e=u.length;e--;){var r=moment(u[e].replace(n+"_",""),"x"),a=moment().diff(r,"hours")<1?r.fromNow():r.format("MM/DD/YYYY h:mm a");t+='<li><a href="javascript:void(0)" data-id="'+u[e]+'">'+a+"</a></li>"}u.length||(t='<li><a href="javascript:void(0)">No Autosaves, type something :)</a></li>'),$("#"+o).find(".autoSaveMenu").html(t)},g=function(t){l&&clearTimeout(l),l=setTimeout(f,a.timeout,t)},f=function(t){if(d)g(t);else{d=!0;var e=n+"_"+Date.now();localStorage.setItem(e,LZString.compressToUTF16(getEditorContent())),s(e),d=!1}};getContentEditor().on("change",g),$("#"+o).on("click","li > a",(function(t){var e,o;e=$(t.currentTarget).data("id"),o=localStorage.getItem(e),setEditorContent("content",LZString.decompressFromUTF16(o)),l&&clearTimeout(l)})),c()};